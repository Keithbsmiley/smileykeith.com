<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width">
  
    <title>Vim TagBar with Objective-C - Keith Smiley</title>
  

    <meta name="author" content="Keith Smiley">
    <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/atom.xml">

    <link rel="icon" href="/images/favicon.png" type="image/x-icon">
    <link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon">

    <link rel="stylesheet" type="text/css" href="/css/style.css" title="default">
  </head>
  <body>
    <section class="container">
      <div id="masthead">
        <h1>
          <a href="/">Keith Smiley</a>
          - <a href="http://keith.so" title="Who is this guy?">Who?</a>
        </h1>
      </div>

      <section class="content">
        
<article>

  <header class="seven columns">
    
      <h2>Vim TagBar with Objective-C</h2>
    
    <p>
      <time datetime="2014-02-14 13:53:00 -0800" pubdate="pubdate">
        14 Feb 2014
      </time>
      <a class="permalink" title="Permalink" href="/2014/02/14/vim-tagbar-with-objective-c/">&infin;</a>
    </p>
  </header>

  <div class="post ten columns">
    <p>When working with large files in Vim,
<a href="http://majutsushi.github.io/tagbar/">Tagbar</a> has become an invaluable
part of my workflow. It provides a succinct list of methods, modules,
variables and other language specific constructs. When I started trying
to spend more time in Vim writing Objective-C I was disappointed to see
that, out of the box, it was not supported.</p>

<p>Hopefully in the future it won't be difficult to set this up in Vim.
Currently ctags <a href="https://svn.code.sf.net/p/ctags/code/trunk/objc.c">already
has</a> built in support
for Objective-C. Unfortunately there hasn't been a release of ctags
since 2009. As recommended in the <a href="http://bastibe.de/2011-12-04-how-to-make-tagbar-work-with-objective-c.html">canonical how to
article</a>
you can attempt to use the trunk version of ctags and just define the
Tagbar settings. For me, this ended up producing a ton of
mis-categorized duplicates. I also opened and closed <a href="https://github.com/majutsushi/tagbar/issues/193">an
issue</a> on the Tagbar
Github repo hoping that Objective-C support will be added by default in
the future.</p>

<p>The only other resource I could find about this issue was <a href="https://gist.github.com/yamaya/5598909">this
gist</a>. It uses regex to define
Objective-C to ctags and then match it with Tagbar. I improved it a
little bit and came up with this. Put this file anywhere you want, you
will define its path in your vimrc.</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>--langdef=objc
--langmap=objc:.m..mm..h
--regex-objc=/\@interface[[:space:]]+([[:alnum:]_]+)/\1/i,interface/
--regex-objc=/\@implementation[[:space:]]+([[:alnum:]_]+)/\1/I,implementation/
--regex-objc=/\@protocol[[:space:]]+([[:alnum:]_]+)/\1/P,protocol/
--regex-objc=/\@property[[:space:]]+\([[:alnum:],[:space:]]+\)[[:space:]]+[[:alnum:]_]+[[:space:]]+\*?([[:alnum:]_]+)/\1/p,property/
--regex-objc=/([-+])[[:space:]]*\([[:alpha:]_][^)]*\)[[:space:]]*([[:alpha:]_][^:;{]+).*/\1\2/M,method definition/
--regex-objc=/^[^#@[:space:]][^=]*[[:space:]]([[:alpha:]_][[:alnum:]_]*)[[:space:]]*=/\1/c,constant/
--regex-objc=/^[[:space:]]*typedef[[:space:]][^;]+[[:space:]]([[:alpha:]_][[:alnum:]]*)[[:space:]]*;/\1/t,typedef/
--regex-objc=/^[[:space:]]*NS_ENUM\([[:alnum:]]+[[:space:]]*,[[:space:]]([[:alnum:]]+)\)/\1/e,enum/
--regex-objc=/^#pragma[[:space:]]+mark[[:space:]]+-?[[:space:]]+([[:alnum:][:space:]]+)/\1/g,pragma/
</code></pre></div></div>

<p>Then in your vimrc:</p>

<figure class="highlight"><pre><code class="language-vim" data-lang="vim"><span class="k">let</span> <span class="nv">g:tagbar_type_objc</span> <span class="p">=</span> <span class="p">{</span>
<span class="se">  \</span> <span class="s1">'ctagstype'</span><span class="p">:</span> <span class="s1">'objc'</span><span class="p">,</span>
<span class="se">  \</span> <span class="s1">'ctagsargs'</span><span class="p">:</span> <span class="p">[</span>
<span class="se">    \</span> <span class="s1">'-f'</span><span class="p">,</span>
<span class="se">    \</span> <span class="s1">'-'</span><span class="p">,</span>
<span class="se">    \</span> <span class="s1">'--excmd=pattern'</span><span class="p">,</span>
<span class="se">    \</span> <span class="s1">'--extra='</span><span class="p">,</span>
<span class="se">    \</span> <span class="s1">'--format=2'</span><span class="p">,</span>
<span class="se">    \</span> <span class="s1">'--fields=nksaSmt'</span><span class="p">,</span>
<span class="se">    \</span> <span class="s1">'--options='</span> <span class="p">.</span> expand<span class="p">(</span><span class="s1">'~/.vim/objctags'</span><span class="p">),</span>
<span class="se">    \</span> <span class="s1">'--objc-kinds=-N'</span><span class="p">,</span>
<span class="se">  \</span> <span class="p">],</span>
<span class="se">  \</span> <span class="s1">'sro'</span><span class="p">:</span> <span class="s1">' '</span><span class="p">,</span>
<span class="se">  \</span> <span class="s1">'kinds'</span><span class="p">:</span> <span class="p">[</span>
<span class="se">    \</span> <span class="s1">'c:constant'</span><span class="p">,</span>
<span class="se">    \</span> <span class="s1">'e:enum'</span><span class="p">,</span>
<span class="se">    \</span> <span class="s1">'t:typedef'</span><span class="p">,</span>
<span class="se">    \</span> <span class="s1">'i:interface'</span><span class="p">,</span>
<span class="se">    \</span> <span class="s1">'P:protocol'</span><span class="p">,</span>
<span class="se">    \</span> <span class="s1">'p:property'</span><span class="p">,</span>
<span class="se">    \</span> <span class="s1">'I:implementation'</span><span class="p">,</span>
<span class="se">    \</span> <span class="s1">'M:method'</span><span class="p">,</span>
<span class="se">    \</span> <span class="s1">'g:pragma'</span><span class="p">,</span>
<span class="se">  \</span> <span class="p">],</span>
<span class="se">\</span> <span class="p">}</span></code></pre></figure>

<p>Replace the <code class="highlighter-rouge">~/.vim/objctags</code> with the path where you chose to put the
first file. Please let me know if you see any way that this could be
improved.</p>

  </div>
</article>

<div class="ten columns blogarchive">
  <a href="/archives/">Blog Archive</a>
</div>

      </section>
    </section>
  </body>
</html>
