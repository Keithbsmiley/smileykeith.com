/* smileykeith.com/humans.txt for more info */ window.Mousetrap=function(){function I(h,i,f){if(h.addEventListener){return h.addEventListener(i,f,!1)}h.attachEvent("on"+i,f)}function g(f){return"keypress"==f.type?String.fromCharCode(f.which):O[f.which]?O[f.which]:e[f.which]?e[f.which]:String.fromCharCode(f.which).toLowerCase()}function H(h){var h=h||{},i=!1,f;for(f in K){h[f]?i=!0:K[f]=0}i||(J=!1)}function d(i,p,h,o,n){var j,l,k=[];if(!M[i]){return[]}"keyup"==h&&F(i)&&(p=[i]);for(j=0;j<M[i].length;++j){if(l=M[i][j],!(l.seq&&K[l.seq]!=l.level)&&h==l.action&&("keypress"===h||p.sort().join(",")===l.modifiers.sort().join(","))){o&&l.combo==n&&M[i].splice(j,1),k.push(l)}}return k}function D(f,h){!1===f(h)&&(h.preventDefault&&h.preventDefault(),h.stopPropagation&&h.stopPropagation(),h.returnValue=!1,h.cancelBubble=!0)}function C(i){i.which="number"==typeof i.which?i.which:i.keyCode;var n=g(i);if(n){if("keyup"===i.type&&m===n){m=!1}else{var h=i.target||i.srcElement,l=h.tagName;if(!(-1<(" "+h.className+" ").indexOf(" mousetrap ")?0:"INPUT"==l||"SELECT"==l||"TEXTAREA"==l)){h=[];i.shiftKey&&h.push("shift");i.altKey&&h.push("alt");i.ctrlKey&&h.push("ctrl");i.metaKey&&h.push("meta");for(var h=d(n,h,i.type),k={},j=!1,l=0;l<h.length;++l){h[l].seq?(j=!0,k[h[l].seq]=1,D(h[l].callback,i)):!j&&!J&&D(h[l].callback,i)}i.type==J&&!F(n)&&H(k)}}}}function F(f){return"shift"==f||"ctrl"==f||"alt"==f||"meta"==f}function c(h,j,f){if(!f){if(!L){L={};for(var i in O){95<i&&112>i||O.hasOwnProperty(i)&&(L[O[i]]=i)}}f=L[h]?"keydown":"keypress"}"keypress"===f&&j.length&&(f="keydown");return f}function b(v,t,u,s,q){var v=v.replace(/\s+/g," "),p=v.split(" "),r,o,n=[];if(1<p.length){var l=v,j=u;K[l]=0;j||(j=c(p[0],[]));v=function(){J=j;++K[l];clearTimeout(a);a=setTimeout(H,1000)};u=function(f){D(t,f);"keyup"!==j&&(m=g(f));setTimeout(H,10)};for(s=0;s<p.length;++s){b(p[s],s<p.length-1?v:u,j,l,s)}}else{o="+"===v?["+"]:v.split("+");for(p=0;p<o.length;++p){r=o[p],G[r]&&(r=G[r]),u&&("keypress"!=u&&E[r])&&(r=E[r],n.push("shift")),F(r)&&n.push(r)}u=c(r,n,u);M[r]||(M[r]=[]);d(r,n,u,!s,v);M[r][s?"unshift":"push"]({callback:t,modifiers:n,action:u,seq:s,level:q,combo:v})}}for(var O={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},e={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},E={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},G={option:"alt",command:"meta","return":"enter",escape:"esc"},L,M={},N={},K={},a,m=!1,J=!1,P=1;20>P;++P){O[111+P]="f"+P}for(P=96;106>P;++P){O[P]=P-96}I(document,"keypress",C);I(document,"keydown",C);I(document,"keyup",C);return{bind:function(i,l,h){for(var k=i instanceof Array?i:[i],j=0;j<k.length;++j){b(k[j],l,h)}N[i+":"+h]=l},unbind:function(f,h){N[f+":"+h]&&(delete N[f+":"+h],this.bind(f,function(){},h))},trigger:function(f,h){N[f+":"+h]()},reset:function(){M={};N={}}}}();